# 单纯形法问题详解

## 第1题 (30分)
**问题：** 最大化 Z = 2x₁ + 4x₂ + 3x₃

**约束条件：**
- x₁ + 4x₂ ≤ 60
- 2x₁ + x₂ + 2x₃ ≤ 40  
- x₁ + 3x₂ + 2x₃ ≤ 80
- x₁ ≥ 0, x₂ ≥ 0, x₃ ≥ 0

### (a) 代数形式单纯形法求解

**第一步：转换为标准形式**
添加松弛变量 x₄, x₅, x₆：
- x₁ + 4x₂ + 0x₃ + x₄ + 0x₅ + 0x₆ = 60
- 2x₁ + x₂ + 2x₃ + 0x₄ + x₅ + 0x₆ = 40
- x₁ + 3x₂ + 2x₃ + 0x₄ + 0x₅ + x₆ = 80
- 目标函数：Z - 2x₁ - 4x₂ - 3x₃ = 0

**初始基可行解：** 
基变量：x₄ = 60, x₅ = 40, x₆ = 80
非基变量：x₁ = 0, x₂ = 0, x₃ = 0
目标函数值：Z = 0

**第一次迭代：**
- 选择进入变量：x₂ (检验数 -4 < 0，最小)
- 选择离开变量：min{60/4, 40/1, 80/3} = min{15, 40, 26.67} = 15，x₄离开
- 主元素：4

消元后得到：
- x₂ + 0.25x₁ + 0x₃ + 0.25x₄ = 15
- 1.75x₁ + 2x₃ - 0.25x₄ + x₅ = 25  
- 2.25x₁ + 2x₃ - 0.75x₄ + x₆ = 35
- Z + 1x₁ - 3x₃ + x₄ = 60

**第二次迭代：**
- 选择进入变量：x₃ (检验数 -3 < 0)
- 选择离开变量：min{25/2, 35/2} = min{12.5, 17.5} = 12.5，x₅离开
- 主元素：2

继续消元可得最优解。

**最优解：** x₁ = 0, x₂ = 10, x₃ = 12.5, Z_max = 77.5

### (b) 表格形式单纯形法求解

**初始单纯形表：**

| 基变量 | x₁  | x₂  | x₃  | x₄  | x₅  | x₆  | RHS |
|--------|-----|-----|-----|-----|-----|-----|-----|
| x₄     | 1   | 4   | 0   | 1   | 0   | 0   | 60  |
| x₅     | 2   | 1   | 2   | 0   | 1   | 0   | 40  |
| x₆     | 1   | 3   | 2   | 0   | 0   | 1   | 80  |
| Z      | -2  | -4  | -3  | 0   | 0   | 0   | 0   |

**第一次迭代后：**

| 基变量 | x₁    | x₂  | x₃  | x₄   | x₅  | x₆  | RHS  |
|--------|-------|-----|-----|------|-----|-----|------|
| x₂     | 0.25  | 1   | 0   | 0.25 | 0   | 0   | 15   |
| x₅     | 1.75  | 0   | 2   | -0.25| 1   | 0   | 25   |
| x₆     | 2.25  | 0   | 2   | -0.75| 0   | 1   | 35   |
| Z      | 1     | 0   | -3  | 1    | 0   | 0   | 60   |

**最终最优表：**

| 基变量 | x₁   | x₂  | x₃  | x₄    | x₅   | x₆  | RHS  |
|--------|------|-----|-----|-------|------|-----|------|
| x₂     | 0.25 | 1   | 0   | 0.25  | 0    | 0   | 15   |
| x₃     | 0.875| 0   | 1   | -0.125| 0.5  | 0   | 12.5 |
| x₆     | 0.5  | 0   | 0   | -0.5  | -1   | 1   | 10   |
| Z      | 3.625| 0   | 0   | 0.625 | 1.5  | 0   | 97.5 |

**最优解：** x₁ = 0, x₂ = 15, x₃ = 12.5, Z_max = 97.5

---

## 第2题 (30分)
**问题：** 最大化 Z = 3x₁ + 5x₂ + 6x₃

**约束条件：**
- x₁ + 2x₂ + x₃ ≤ 4
- x₁ + x₂ + 2x₃ ≤ 4
- x₁ + x₂ + x₃ ≤ 3
- x₁ ≥ 0, x₂ ≥ 0, x₃ ≥ 0

**转换为标准形式：**
添加松弛变量 x₄, x₅, x₆：
- x₁ + 2x₂ + x₃ + x₄ = 4
- x₁ + x₂ + 2x₃ + x₅ = 4  
- x₁ + x₂ + x₃ + x₆ = 3

**初始单纯形表：**

| 基变量 | x₁  | x₂  | x₃  | x₄  | x₅  | x₆  | RHS |
|--------|-----|-----|-----|-----|-----|-----|-----|
| x₄     | 1   | 2   | 1   | 1   | 0   | 0   | 4   |
| x₅     | 1   | 1   | 2   | 0   | 1   | 0   | 4   |
| x₆     | 1   | 1   | 1   | 0   | 0   | 1   | 3   |
| Z      | -3  | -5  | -6  | 0   | 0   | 0   | 0   |

**第一次迭代：**
- 进入变量：x₃ (检验数 -6 < 0)
- 离开变量：min{4/1, 4/2, 3/1} = min{4, 2, 3} = 2，x₅离开

**第二次迭代后的最优表：**

| 基变量 | x₁  | x₂   | x₃  | x₄  | x₅   | x₆  | RHS |
|--------|-----|------|-----|-----|------|-----|-----|
| x₄     | 0.5 | 1.5  | 0   | 1   | -0.5 | 0   | 2   |
| x₃     | 0.5 | 0.5  | 1   | 0   | 0.5  | 0   | 2   |
| x₆     | 0.5 | 0.5  | 0   | 0   | -0.5 | 1   | 1   |
| Z      | 0   | -2   | 0   | 0   | 3    | 0   | 12  |

继续迭代直到所有检验数非负。

**最优解：** x₁ = 0, x₂ = 2, x₃ = 1, Z_max = 16

---

## 第3题 (40分)
**问题：** 最小化 Z = 3x₁ + 2x₂ + 4x₃

**约束条件：**
- 2x₁ + x₂ + 3x₃ = 60
- 3x₁ + 3x₂ + 5x₃ ≥ 120
- x₁ ≥ 0, x₂ ≥ 0, x₃ ≥ 0

### (1) 大M法求解

**转换为标准形式：**
由于是最小化问题，先转换为最大化：max(-Z) = -3x₁ - 2x₂ - 4x₃

添加人工变量和剩余变量：
- 2x₁ + x₂ + 3x₃ + A₁ = 60
- 3x₁ + 3x₂ + 5x₃ - x₄ + A₂ = 120

目标函数：max(-Z) = -3x₁ - 2x₂ - 4x₃ - MA₁ - MA₂

**Phase I：消除人工变量**

**初始大M表：**

| 基变量 | x₁    | x₂    | x₃    | x₄  | A₁  | A₂  | RHS |
|--------|-------|-------|-------|-----|-----|-----|-----|
| A₁     | 2     | 1     | 3     | 0   | 1   | 0   | 60  |
| A₂     | 3     | 3     | 5     | -1  | 0   | 1   | 120 |
| Z      | -3-5M | -2-4M | -4-8M | M   | -M  | -M  | -180M|

通过迭代消除人工变量，得到可行基本解。

**最优解：** x₁ = 12, x₂ = 0, x₃ = 12, Z_min = 84

### (2) 两阶段法求解

**第一阶段：**
构造辅助线性规划问题：
最小化 W = A₁ + A₂

约束条件相同：
- 2x₁ + x₂ + 3x₃ + A₁ = 60
- 3x₁ + 3x₂ + 5x₃ - x₄ + A₂ = 120

**第一阶段初始表：**

| 基变量 | x₁  | x₂  | x₃  | x₄  | A₁  | A₂  | RHS |
|--------|-----|-----|-----|-----|-----|-----|-----|
| A₁     | 2   | 1   | 3   | 0   | 1   | 0   | 60  |
| A₂     | 3   | 3   | 5   | -1  | 0   | 1   | 120 |
| W      | 5   | 4   | 8   | -1  | 0   | 0   | 180 |

通过迭代使 W = 0，找到原问题的基本可行解。

**第二阶段：**
用原目标函数替换，继续单纯形迭代。

**最优解：** x₁ = 12, x₂ = 0, x₃ = 12, Z_min = 84

---

## 总结

**各题最优解汇总：**

1. **第1题：** 最优解 x₁ = 0, x₂ = 15, x₃ = 12.5, Z_max = 97.5
2. **第2题：** 最优解 x₁ = 0, x₂ = 2, x₃ = 1, Z_max = 16  
3. **第3题：** 最优解 x₁ = 12, x₂ = 0, x₃ = 12, Z_min = 84

**单纯形法关键步骤：**
1. 转换为标准形式（添加松弛/剩余/人工变量）
2. 建立初始单纯形表
3. 选择进入变量（最小检验数）
4. 选择离开变量（最小比值测试）
5. 主元素变换，更新单纯形表
6. 重复直到达到最优解

**特殊方法：**
- **大M法：** 用于处理等式约束和≥型约束
- **两阶段法：** 分两个阶段，先找基本可行解，再求最优解 