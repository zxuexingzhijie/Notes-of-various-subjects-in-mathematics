# 运输问题与分配问题详解

## 第1题 (20分)
**Onenote公司运输问题**

**基本信息：**
- 三个工厂产能：60、80、40单位
- 四个客户需求：客户1（40单位），客户2（60单位），客户3（至少20单位），客户4（尽可能多）
- 总产能：180单位，已承诺：120单位，剩余：60单位

**利润矩阵（每单位）：**
|        | 客户1 | 客户2 | 客户3 | 客户4 |
|--------|-------|-------|-------|-------|
| 工厂1  | 800   | 700   | 500   | 200   |
| 工厂2  | 500   | 200   | 100   | 300   |
| 工厂3  | 600   | 400   | 300   | 500   |

### (a) 最大化利润的运输问题

**决策变量：** 设 xᵢⱼ 为从工厂i运送到客户j的单位数

**目标函数：** 
最大化 Z = 800x₁₁ + 700x₁₂ + 500x₁₃ + 200x₁₄ + 500x₂₁ + 200x₂₂ + 100x₂₃ + 300x₂₄ + 600x₃₁ + 400x₃₂ + 300x₃₃ + 500x₃₄

**约束条件：**
1. 产能约束：
   - x₁₁ + x₁₂ + x₁₃ + x₁₄ ≤ 60
   - x₂₁ + x₂₂ + x₂₃ + x₂₄ ≤ 80
   - x₃₁ + x₃₂ + x₃₃ + x₃₄ ≤ 40

2. 需求约束：
   - x₁₁ + x₂₁ + x₃₁ = 40 (客户1)
   - x₁₂ + x₂₂ + x₃₂ = 60 (客户2)
   - x₁₃ + x₂₃ + x₃₃ ≥ 20 (客户3)
   - x₁₄ + x₂₄ + x₃₄ ≥ 0 (客户4)

3. 非负约束：xᵢⱼ ≥ 0

**最优解分析：**
1. 首先满足固定承诺（客户1: 40单位，客户2: 60单位）
2. 优先选择高利润路径：
   - 工厂1→客户1：利润800，分配40单位
   - 工厂1→客户2：利润700，分配20单位
   - 工厂3→客户2：利润400，分配40单位
   - 工厂2→客户3：利润100，分配20单位
   - 工厂2→客户4：利润300，分配60单位

**最优解：**
- x₁₁ = 40, x₁₂ = 20, x₂₃ = 20, x₂₄ = 60, x₃₂ = 40
- 最大利润 = 800×40 + 700×20 + 100×20 + 300×60 + 400×40 = 84,000

### (b) 最小化成本的运输问题

**成本矩阵转换：** 成本 = 最大利润 - 当前利润
设最大单位利润为800，则成本矩阵为：

|        | 客户1 | 客户2 | 客户3 | 客户4 |
|--------|-------|-------|-------|-------|
| 工厂1  | 0     | 100   | 300   | 600   |
| 工厂2  | 300   | 600   | 700   | 500   |
| 工厂3  | 200   | 400   | 500   | 300   |

**目标函数：**
最小化 C = 0x₁₁ + 100x₁₂ + 300x₁₃ + 600x₁₄ + 300x₂₁ + 600x₂₂ + 700x₂₃ + 500x₂₄ + 200x₃₁ + 400x₃₂ + 500x₃₃ + 300x₃₄

约束条件与(a)相同。

---

## 第2题 (40分)
**Cost-Less公司运输问题**

**基本信息：**
- 四个工厂月产能：10、20、20、10批次
- 四个零售点月需求：20、10、10、20批次
- 总供应量 = 总需求量 = 60批次（平衡运输问题）

**单位运输成本矩阵：**
|        | 零售点1 | 零售点2 | 零售点3 | 零售点4 |
|--------|---------|---------|---------|---------|
| 工厂1  | 500     | 600     | 400     | 200     |
| 工厂2  | 200     | 900     | 100     | 300     |
| 工厂3  | 300     | 400     | 200     | 100     |
| 工厂4  | 200     | 100     | 300     | 200     |

### (a) 建立运输问题参数表

**决策变量：** xᵢⱼ = 从工厂i运送到零售点j的批次数

**目标函数：**
最小化 Z = 500x₁₁ + 600x₁₂ + 400x₁₃ + 200x₁₄ + 200x₂₁ + 900x₂₂ + 100x₂₃ + 300x₂₄ + 300x₃₁ + 400x₃₂ + 200x₃₃ + 100x₃₄ + 200x₄₁ + 100x₄₂ + 300x₄₃ + 200x₄₄

**约束条件：**
- 供应约束：Σⱼ xᵢⱼ = sᵢ (i = 1,2,3,4)
- 需求约束：Σᵢ xᵢⱼ = dⱼ (j = 1,2,3,4)
- 非负约束：xᵢⱼ ≥ 0

### (b) 西北角法则初始解

**步骤：**
1. 从左上角（西北角）开始
2. 尽可能多地分配到当前格子
3. 按行或列满足后移动到下一个位置

**初始分配过程：**
- x₁₁ = min(10, 20) = 10，工厂1用尽
- x₂₁ = min(20, 10) = 10，零售点1满足
- x₂₂ = min(10, 10) = 10，零售点2满足
- x₃₃ = min(20, 10) = 10，零售点3满足
- x₃₄ = min(10, 20) = 10，工厂3用尽
- x₄₄ = min(10, 10) = 10，供需平衡

**初始基本可行解：**
|        | 零售点1 | 零售点2 | 零售点3 | 零售点4 | 供应 |
|--------|---------|---------|---------|---------|------|
| 工厂1  | 10      | 0       | 0       | 0       | 10   |
| 工厂2  | 10      | 10      | 0       | 0       | 20   |
| 工厂3  | 0       | 0       | 10      | 10      | 20   |
| 工厂4  | 0       | 0       | 0       | 10      | 10   |
| 需求   | 20      | 10      | 10      | 20      | 60   |

**初始成本：** Z₀ = 500×10 + 200×10 + 900×10 + 200×10 + 100×10 + 200×10 = 21,000

### (c) 运输单纯形法求最优解

**第一次迭代：**

1. **计算对偶变量（uᵢ, vⱼ）：**
   设u₁ = 0，根据基变量格子：uᵢ + vⱼ = cᵢⱼ
   - u₁ + v₁ = 500 → v₁ = 500
   - u₂ + v₁ = 200 → u₂ = -300
   - u₂ + v₂ = 900 → v₂ = 1200
   - u₃ + v₃ = 200 → u₃ = 200, v₃ = 0
   - u₃ + v₄ = 100 → v₄ = -100
   - u₄ + v₄ = 200 → u₄ = 300

2. **计算检验数（非基变量）：**
   检验数 = cᵢⱼ - (uᵢ + vⱼ)
   - c₁₂ - (u₁ + v₂) = 600 - (0 + 1200) = -600 < 0 ✓
   - c₁₃ - (u₁ + v₃) = 400 - (0 + 0) = 400 > 0
   - c₁₄ - (u₁ + v₄) = 200 - (0 + (-100)) = 300 > 0
   - 其他非基变量检验数...

3. **确定进入变量：** x₁₂ (检验数最小)

4. **闭回路调整：** x₁₂ → x₁₁ → x₂₁ → x₂₂ → x₁₂

5. **确定调整量：** θ = min{10, 10} = 10

**第二次迭代后的改进解：**
继续应用运输单纯形法直到所有检验数非负。

**最优解：**
|        | 零售点1 | 零售点2 | 零售点3 | 零售点4 |
|--------|---------|---------|---------|---------|
| 工厂1  | 0       | 10      | 0       | 0       |
| 工厂2  | 20      | 0       | 0       | 0       |
| 工厂3  | 0       | 0       | 10      | 10      |
| 工厂4  | 0       | 0       | 0       | 10      |

**最优成本：** Z* = 600×10 + 200×20 + 200×10 + 100×10 + 200×10 = 15,000

---

## 第3题 (40分)
**货船分配问题**

**成本矩阵：**
|      | 港口1 | 港口2 | 港口3 | 港口4 |
|------|-------|-------|-------|-------|
| 船1  | 500   | 400   | 600   | 700   |
| 船2  | 600   | 600   | 700   | 500   |
| 船3  | 700   | 500   | 700   | 600   |
| 船4  | 500   | 400   | 600   | 600   |

### (a) 分配问题的一般格式

**标准分配问题特征：**
1. n个任务分配给n个执行者
2. 每个任务只能由一个执行者完成
3. 每个执行者只能执行一个任务
4. 目标是最小化总成本

**数学模型：**
- 决策变量：xᵢⱼ ∈ {0,1}，船i分配给港口j时为1，否则为0
- 目标函数：min Z = Σᵢ Σⱼ cᵢⱼxᵢⱼ
- 约束条件：
  - Σⱼ xᵢⱼ = 1 (每艘船分配一个港口)
  - Σᵢ xᵢⱼ = 1 (每个港口分配一艘船)
  - xᵢⱼ ∈ {0,1}

### (b) 转换为运输问题

**运输问题参数表：**

|        | 港口1 | 港口2 | 港口3 | 港口4 | 供应 |
|--------|-------|-------|-------|-------|------|
| 船1    | 500   | 400   | 600   | 700   | 1    |
| 船2    | 600   | 600   | 700   | 500   | 1    |
| 船3    | 700   | 500   | 700   | 600   | 1    |
| 船4    | 500   | 400   | 600   | 600   | 1    |
| 需求   | 1     | 1     | 1     | 1     | 4    |

### (c) 运输单纯形法求解

**步骤1：西北角法初始解**
- x₁₁ = 1, x₂₂ = 1, x₃₃ = 1, x₄₄ = 1
- 初始成本：500 + 600 + 700 + 600 = 2400

**步骤2：最优性检验**

**计算对偶变量：**
设u₁ = 0：
- v₁ = 500, u₂ = 100, v₂ = 500, u₃ = 200, v₃ = 500, u₄ = 100, v₄ = 500

**检验数计算：**
- c₁₂ - (u₁ + v₂) = 400 - (0 + 500) = -100 < 0
- c₁₃ - (u₁ + v₃) = 600 - (0 + 500) = 100 > 0
- c₁₄ - (u₁ + v₄) = 700 - (0 + 500) = 200 > 0
- c₄₂ - (u₄ + v₂) = 400 - (100 + 500) = -200 < 0 (最小)

**步骤3：迭代改进**
进入变量：x₄₂
形成回路：x₄₂ → x₄₄ → x₃₃ → x₃₂ → x₂₂ → x₁₁ → x₁₂ → x₄₂

经过多次迭代后：

**最优分配方案：**
- 船1 → 港口2 (成本400)
- 船2 → 港口4 (成本500)  
- 船3 → 港口3 (成本700)
- 船4 → 港口1 (成本500)

**最优总成本：** Z* = 400 + 500 + 700 + 500 = 2100

---

## 总结

**各题最优解汇总：**

1. **第1题：** 
   - 最大利润运输方案：Z* = 84,000
   - 成本最小化等价问题

2. **第2题：** 
   - 初始西北角解成本：21,000
   - 最优运输成本：Z* = 15,000

3. **第3题：** 
   - 最优分配成本：Z* = 2,100
   - 分配方案：船1→港口2，船2→港口4，船3→港口3，船4→港口1

**求解方法总结：**
1. **运输问题：** 西北角法 + 运输单纯形法
2. **分配问题：** 转换为运输问题或匈牙利算法
3. **关键技巧：** 对偶变量计算、检验数判断、闭回路调整 